\documentclass[reqno]{article}

\usepackage{fullpage}
\usepackage{eufrak}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{enumitem}


% \usepackage{nth}
\usepackage{amsthm, amsmath, amsfonts, amssymb}


%formatting
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\renewcommand{\baselinestretch}{1.2}
\sloppy

\setlength{\parindent}{0pt}
\setlength{\parskip}{0.3em}

\usepackage{multicol}
\usepackage{color}

% Languages, fonts and symbols
\usepackage[english,russian]{babel}
\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage{amsmath}

\usepackage{graphicx}

\usepackage{subcaption}

\usepackage{amssymb}

\usepackage{listings}

\usepackage{float}

\usepackage{dsfont}

\usepackage{ragged2e}

\usepackage{tabularx}


%\usepackage{algorithm}
\usepackage[ruled,vlined]{algorithm2e}

\SetKwInput{KwInput}{Input}                % Set the Input
\SetKwInput{KwOutput}{Output}              % set the Output


% tikz graphics
% Для коммутативных диаграмм.
\usepackage{tikz}
\usetikzlibrary{arrows,shapes}
\tikzstyle{vertex}=[circle,fill=black,minimum size=3pt,inner sep=0pt]
\tikzstyle{edge} = [draw,thick,-]

\usepackage{tikz-cd}

\usetikzlibrary{quotes,babel,angles}


% Теоремы и прочее
\renewcommand\qedsymbol{$\square$}

\theoremstyle{definition}
\newtheorem*{nb}{Замечание}

\theoremstyle{definition}
\newtheorem*{sol}{Решение}

\theoremstyle{definition}
\newtheorem*{exmp}{Пример}

\theoremstyle{definition}
\newtheorem*{exmps}{Примеры}

\theoremstyle{definition}
\newtheorem{exc}{Упражнение}[section]

\theoremstyle{definition}
\newtheorem{thm}{Теорема}[section]

\theoremstyle{definition}
\newtheorem*{defi}{Определение}

\theoremstyle{definition}
\newtheorem{coll}{Следствие}[section]

\theoremstyle{definition}
\newtheorem{state}{Утверждение}[section]


%Content as links
% Для того, чтобы оглавление стало ссылками, убрать комментирование кода ниже.

\usepackage[hidelinks]{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
   urlcolor=black
}


% Title
\title{Управление доходами.\\ (Revenue Managemt)\\ Лекции.\\ ЧЕРНОВИК}
\author{Лектор: Фридман Г.М.\\  \\ Автор конспекта: Курмазов Ф.А.\thanks{Saint-Petersburg State University of Economics, Faculty of Informatics and Applied Mathematics.}}
\date{\today}


% New Symbols
\newcommand*{\divby}{\mathrel{\rotatebox{90}{$\hskip-1pt.{}.{}.$}}}%




\begin{document}

	\maketitle

	\tableofcontents

	
	%%%%%
	\newpage
	\section{Принятые обозначения.}

		\begin{enumerate}
			\item 123
			\item $\mathds{N} = \{0, 1, 2, 3, ...\}$ -- множество натуральных чисел и $0$;
			\item $[n] = \{1, 2, 3, ... n\}$ где $n \in \mathds{N}$ -- множество чисел от $1$ до $n$.
		\end{enumerate}

	%%%%%
	\newpage
	\section{Лекция 1. Введение в управление доходами.}
		%%%
		\subsection{Формулировка задачи.}
			
		Управление доходами (англ. Revenue Management) -- область исследования операций, занимающаяся моделлированием и оптимизацией процессов, связанных с оптимизацией поведения производителя товаров/услуг на микро уровне. Основная задача управления доходами -- продажа правильного товара, правильному покупателю, в правильном месте, в правильное время, с целью максимизации роста выручки. Таким образом область сочетает в себе методы оптимизации, математической статистики, микроэкономики.
		
		%%%
		\subsection{Задача определения оптимальной стратегии продаж авиакомпании.}
			Авиакомпания предлагает на рынке ряд продуктов, каждый из которых представляет собой комбинацию ``маршрут и класс билета'', где класс билета -- эквивалентен его цене. Спрос на каждый продукт, обычно, предсказывается заранее и разбивается на несколько временных интервалов DCP (англ. data collection periods).
			
			Авиакомпания стремится продавать все продукты таким образом, чтобы получить максимальных доход, учитывая при этом естественные ограничения: общий спрос, цена билетов, вместимость самолетов на рейсах, из которых состоят маршруты. Другими словами, авиакомпания стремится найти оптимальную стратегию продаж, основанную на прогнозе спроса, физических ограничениях и реальном потоке запросов/покупателей.
		
		%%%
		\subsection{DLP - простейшая модель оптимизации стратегии продаж авиакомпании.}
		
		При заданных:
		\begin{itemize}
			\item Множество рейсов $[F]$, $F \in \mathds{N}$;
			\item Множество продуктов $[N]$, $N \in \mathds{N}$;
			\item Вектор вместимости рейсов $Cap \in \mathds{N}^F$;
			\item Вектор стоимостей продуктов $f \in \mathds{R}^N$;
			\item Вектор спрогнозированного спроса на продукты $\mathfrak{D} \in \mathds{N}^N$;
			\item $A$ -- матрица $N\times F$, в которой $a_{i, j} = 1$, если $i$-й рейс является частью $j$-го продукта (i.e. содержится в нем в качестве части маршрута), и $a_{i, j} = 0$ иначе.
		\end{itemize}
		
		Найти вектор $x \in \mathds{N}^N$ -- количество продуктов каждого типа, которое компания разместит на рынке, максимизирующее выручку компании.
		
		Линейная целочисленная программа соответствующая задаче может быть записана:
	
		$$
		\text{(DLP)}
		\begin{cases}
			f^Tx \rightarrow \max & \\
			A^Tx \leq Cap & \\
			0 \leq x \leq \mathfrak{D} & \\
			x \in \mathds{N}^N &
		\end{cases}	
		$$
	
	
	
	%%%%%
	\newpage
	\section{Лекция 2. Имитационная модель.}
	
		Отрывистые замечания о том, что важно учесть при построении имитационной модели процесса продажи продуктов авиакомпании.
		
		Имитационная модель включает в себя:
		\begin{enumerate}
			\item генерацию потока требований (запросов на покупку) в соответствии с известными (заданными) распределениями спроса;
			\item стратегию продаж продукции (обработки запросов на покупку).
		\end{enumerate}
		
		
		%%%
		\subsection{Поток запросов.}
		
		
		Для имитации реального процесса продажи билетов можно принять поток запросов распределенным нормально, с параметрами $\mu = k_1 d_{i t}$, $\sigma = k_2 \sqrt{d_{i t}}$. Где $k_1$, $k_2$ -- ошибки прогноза мат. ожидания и ско соответственно.
		
		Для каждого периода и для каждого вида товара можно сгенерировать (имитация) свой поток запросов на покупку. Каждый такой запрос может быть удовлетворен или отклонен, в зависимости от выбранной стратегии.
		
		При каждом удовлетворении запроса требуется соблюдать естественные ограничения (число оставшихся мест на рейсах).
		
		По результату работы имитационной модели можно оценить отношение полученной выручки (в результате выбранной стратегии) к максимальной выручке, доступной при данном потоке требований.
		
		
		%%%
		\subsection{Стратегии продаж.}
		
		Шкалу времени можно разбить на периоды по DCP (англ. data collection points/periods) -- точкам, в которых компания может принимать управленческие решения.
		
		При использовании прогноза на спрос важно знать точность этого прогноза, для анализа эффективности выработанной стратегии.
		
		Возможные стратегии продаж:
		\begin{itemize}
			\item Первый пришел - первый купил (англ. first come first served -- FCFS).
			\item Оптимальная стратегия для одной начальной точки DCP (1DCP) -- расчет стратегии в начале периода.
			\item Оптимальная стратегия для $k$ точек DCP (kDCP) -- пересчет стратегии в заданных $k$ временных точках.
		\end{itemize}
	
			
		
		
		%%%%%
		\newpage
		\section{Лекция 3. Стохастические модели I. Уровни защиты и вложенные пределы бронирования.}
		
		
		%%%
		\subsection{Пределы бронирования.}
				
		Предел бронирования (англ. booking limit) $b$ -- количество товара, которое компания готова продать в данном и меньших ценовых классах.
	
		Пределы бронирования могут быть вложенными и невложенными. Вложенные пределы бронирования предполагают, что компания готова продать товар меньшей стоимости по стоимости более дорогого товара. Тем не менее, компания ``ждет'' заранее расчитанное количество ``богатых'' покупателей, в связи с чем резервирует для них дорогой товар, и ``защищает'' его от покупки по меньшей стоимости.
		
		Уровень защиты $y$ (англ. protection levels) -- сколько билетов защищено в данном и более высоких ценовых классах.
		
		%%%
		\subsection{Littlewood's rule.}
		
		Для выбора уровня защиты можно оценивать ожидаемую выручку от $k$-го билета дорогого класса, и сравнивать ее с ожидаемой выручкой при продаже этого билета по меньшей стоимости, в зависимости от распределения количества заявок на покупку того или иного класса.
		
		Примером алгоритма выбора предела бронирования в ситуации с 2-мя ценовыми классами является правило Литтлвуда (Littlewood's rule). При наличии 2-ух классов билетов, и при условии, что спрос на дешевый класс избыточен, можем положить, что спрос на дорогой класс имеет функцию распределения ${F}$. Тогда оценить количество мест, которое стоит зарезервировать под дррогой класс можно следующим образом:
		$$limit = \max \{x \mid x \in \mathds{N} \vee E[P(x)] = p_1 * F(x) > p_2\}$$
		\textcolor{red}{Перепроверить что тут вообще написано.}
		
		где $p_1$ $p_2$ цена на дорогой и на дешевый классы соответственно, $P(x)$ -- прибыль от продажи дорогих билетов при пределе бронирования $x$.
		
		Обобщением правила Литтлвуда на произвольное число ценовых классов являются эвристические алгоритмы выбора вложенных пределов бронирования, носящие общее название EMSR (Expected Marginal Set Revenue).
		
		
		%%%
		\subsection{EMSRb.}		
		Применяем правило Литтлвуда к частичным массивам (к подмассивам с 1-го элемента по k-й) последовалтельно идущих ценовых классов (т.е. некоторого супер-класса) и следующему классу за ними. Т.о. получим массив уровней защиты для всех ценовых классов. При этом, супер-класс -- агрегированный набор классов -- может быть распределен как его участники взятые с разными весами.	
		
		...
		
		
		%%%
		\subsection{EMSRa.}
		Применяем правило Литтлвуда для каждых 2-ух последовательно идущих ценовых классов (от большего к меньшему), а затем берем массив частичных сумм полученных уровней защиты в качестве уровней защиты всех ценовых классов.
		
		...
		
	
	%%%%%
	\newpage
	\section{Лекция 4. Стохастические модели II. Стохастические LP.}
			
		%%%
		\subsection{Probabilistic Non-Linear Problem (PNLP).}
		
		\begin{multicols}{2}
			$$
			\text{(DLP)}
			\begin{cases}
				f^Tx \rightarrow \max & \\
				A^Tx \leq Cap & \\
				0 \leq x \leq \mathds{E}(\mathfrak{D}) & \\
			\end{cases}	
			$$
			
			\columnbreak
			
			$$
			\text{(PNLP)}
			\begin{cases}
				\sum\limits_{j=1}^n f_j \mathds{E}(\mathfrak{b_j}) \rightarrow \max & \\
				A^Tx \leq Cap & \\
				x \geq 0 & \\
			\end{cases}
			$$
		\end{multicols}
		
		где $N$ -- количество товаров, $F$ -- количество рейсов, $\mathfrak{D}$ -- вектор спроса ($\mathfrak{D}_j$ -- спрос на $j$ продукт -- дискретная положительная случайная величина), $\mathds{E}$ -- мат. ожидание, $f \in \mathds{R}^N$ -- вектор цен, $A \in \{0, 1\}^{F \times N}$ -- матрица маршрутов, $Cap \in \mathds{Z}^F$ -- вектор вместимости, $x$ -- переменная, обозначающая объемы продукции.
		
		Мы можем предположить, что нам известен закон распределения $\mathfrak{D}_j \sim F_j$, что эквивалентно тому, что известны $Pr[\mathfrak{D}_j = s]\,\forall\,s \in \{0, 1, 2, ...\}$.
		
		Интерпретируем переменную $x_j$ -- как количество товара $j$, которое мы хотим продать. Введем СВ $b_j$ -- количество продукта $j$, которое будет продано, при условии заданного $x_j$. Таким образом $b_j$ -- дискретная случайная величина, которая принимает целочисленные значения от $0$ до $x_j$. На самом деле, $b_j = \min(x_j, \mathfrak{D}_j)$, т.к. мы не можем продать больше заготовленного объема $x_j$. Тогда можем выразить вероятность:
		$$
		Pr[b_j = s] = 
		\begin{cases}
			Pr[\mathfrak{D}_j = s] & 0 \leq s < x_j \\
			Pr[\mathfrak{D}_j \geq x_j] & s = x_j \\
			0 & s > x_j \\
		\end{cases}
		$$
		
		Откуда следует также:
		$$Pr[b_j \geq s] = Pr[\mathfrak{D}_j \geq s]\quad 0 \leq s < x_j$$
		$$Pr[b_j = x_j] = Pr[b_j \geq x_j] = Pr[\mathfrak{D}_j \geq x_j]$$
		
		Приведем определение математического ожидания дискретной СВ $\xi$ со значениями $\{0, 1, 2, 3, ..., S\}$:
		$$\mathds{E}[\xi] = \sum\limits_{s = 0}^S s\,Pr[\xi = s] = Pr[\xi = 1] + 2\,Pr[\xi = 2] + ... + S\,Pr[\xi = S]$$
		
		Перегруппировкой слагаемых легко можно получить формулу
		\begin{equation}
			\mathds{E}[\xi] = \sum\limits_{s = 1}^S Pr[\xi \geq s]
		\end{equation}
	
		Можно воспользоваться ей и расписать математическое ожидание $b_j$:
		$$\mathds{E}[b_j] = \sum\limits_{s = 1}^{x_j} s\,Pr[b_j = s] = \sum\limits_{s = 1}^{x_j} Pr[b_j \geq s] = \sum\limits_{s = 1}^{x_j} Pr[\mathfrak{D}_j \geq s]$$
		
		Введем новое обозначение, и перепишем полученную формулу:
		$$P_{j,s} := Pr[\mathfrak{D}_j \geq s]\quad s = 1, 2, ..., x_j$$
		\begin{equation}
			\mathds{E}[b_j] = \sum\limits_{s = 1}^{x_j} P_{j,s}
		\end{equation}
		
		Тогда получим целевую функцию (для PNLP):
		\begin{equation}
			\sum\limits_{j=1}^n f_j \mathds{E}[b_j] = \sum\limits_{j=1}^n f_j \sum\limits_{s = 1}^{x_j} P_{j,s} \rightarrow \max
		\end{equation}
	
		Но работать с дискретными случайными величинами не всегда удобно. В связи с чем можно перейти к непрерывным. В частности, можно предположить, что спрос распределен нормально.\footnote{Здесь и далее, немного злоупотребляем нотацией, и отождествляем некоторое распределение $\mathcal{A}$ с приписанным дополнительным аргументом $x$ (т.е. $\mathcal{A}(..., x)$) с функцией распределения $\mathcal{A}$.}
		$$\mathds{D}_j \sim \mathcal{N}(\mu_j, \sigma_j) \quad \forall\, j \in [N]$$
		$$\mathcal{N}(\mu, \sigma, x) = \frac{1}{2}(1 + {erf}(\frac{x - \mu}{\sqrt{2}\sigma}))$$
		
		Переходим к аппроксимации дискретного распределения нормальным:
		$$P_{j,s} = Pr[\mathds{D}_j \geq s] \approx 1 - \mathcal{N}(\mu_j, \sigma_j, s)$$
		$$\mathds{E}[b_j] = \sum\limits_{s = 1}^{x_j} (1 - \mathcal{N}(\mu_j, \sigma_j, s))$$
		$$\sum\limits^N_{j = 1} f_j\,\mathds{E}[b_j] = \sum\limits^N_{j = 1} f_j\,\sum\limits_{s = 1}^{x_j} (1 - \mathcal{N}(\mu_j, \sigma_j, s))$$
		
		Но иметь переменный предел суммирования для задачи оптимизации не очень удобно. Обозначим (для удобства нотации) $maxCap := \max_k Cap_k$.\footnote{Такой подход при реализации модели добавит лишних переменных, но зато при ее описании поможет сократить лишние индексы.} Переформулируем задачу так, чтобы избавиться от верхнего предела суммирования. Введем наборы монотонных бинарных переменных $x_{j,s}$ для $s \in [maxCap]$.
		$$
		\begin{cases}
			x_{j,s} =
		\begin{cases}
			1 & \text{для продукта j продаем билет s}\\
			0 & else\\
		\end{cases} & \\
		x_{j,s + 1} - x_{j, s} \leq 0\quad \forall s \in [maxCap - 1] & \\
		\end{cases}
		$$
		
		\textcolor{red}{Дальше могут быть ошибки в индексах, но основной смысл сохранен.}
		
		С новой целевой функцией:
		$$\sum\limits^n_{j = 1} f_j \sum\limits^{maxCap}_{s = 1} x_{j, s}\,(1 - \mathcal{N}(\mu_j, \sigma_j, s)) \rightarrow \max$$
		И новым ограничением вместимости:
		$$\sum\limits_{j : F_j \ni k} \sum\limits^{\max Cap}_{s = 1} x_{j, s} \leq Cap_k \quad \forall\, k \in [F]$$
		
		Получим $0$-$1$ формулировку (PNLP):
		$$
		\text{(0-1 PNLP)}
		\begin{cases}
			\sum\limits^n_{j = 1} f_j \sum\limits^{maxCap}_{s = 1} x_{j, s}\,(1 - \mathcal{N}(\mu_j, \sigma_j, s)) \rightarrow \max & \\
			\sum\limits_{j : F_j \ni k} \sum\limits^{maxCap}_{s = 1} x_{j, s} \leq Cap_k & \forall k \in [F] \\
			x_{j,s + 1} - x_{j, s} \leq 0 \quad & \forall\, j \in [N],\, \forall\, s \in [maxCap - 1] \\
			x_{j, s} \in \{0, 1\} &  \forall\, j \in [N],\, \forall\, s \in [maxCap] \\
		\end{cases}
		$$
		
		где $F_j$ -- рейсы, которые включает в себя $j$-й товар.
		
		%%%
		\subsection{Randomized Linear Problem (RLP).}
		
		$$
		\text{(RLP)}:
		\begin{cases}
			f^Tx \rightarrow \max & \\
			A^Tx \leq Cap & \\
			0 \leq x \leq \mathfrak{D}^i & \\
		\end{cases}	
		$$
		
		где $\mathfrak{D}^i$ -- конкретная реализация спроса.
		
		Модель (RLP) запускается как множество экспериментов, а финальный ответ берется в виде среднего по всем решениям $x^* = \frac{1}{n}\sum\limits^n_{i = 1} {x^*}^i$, с последующим \textit{умным} округлением каждой координаты.
		
		
		
		%%%%%
		\newpage
		\section{Лекция 5. Прогнозирование спроса. Цензурированный спрос.}
		
		%%%
		\subsection{Наивные методы.}
		
		На практике, с целью прогнозирования спроса, могут быть использованы исторические данные (временные ряды). Но у этого подхода есть проблема. Исторические данные о спросе являются цензурированными. Другими словами, мы можем разделить точки истроического периода на истинные и цензурированные (англ. censored), где истинный спрос -- весь истроические спрос, меньший предела продаж в ту же дату, а цензурированный -- точки, в которых количество продаж равно пределу. Это связано с тем, что мы никак не можем отследить спрос, превышающий предел продаж.
		
		В связи с этим возникает отдельная проблема -- оценить распределение спроса в условиях цензурированных исторических данных. Существует множество методов. Рассмотрим наивные:
		
		\textbf{Naive 1:} все цензурированные элементы заменить на среднее по всей выборке. Получим $\pm$ хорошее $\mu$, но плохое $\sigma$, за счет потери дисперсии.
		
		\textbf{Naive 2:} все цензурированные элементы заменить на среднее по нецензурированным.
		
		\textbf{Naive 3:} каждый цензурированный элемент заменить на среднее по нецензурированны, если этот элемент меньше среднего.
		
		%%%
		\subsection{Математическая постановка.}
		
		Спрос на некоторый класс авиабилетов в определенный период времени -- СВ $X$ с функцией распределения $F_X(x; a_1, ... a_p)$. Где $a_1, ... a_p$ -- параметры распределения.
		
		$\overline{x} = (x_1, ... , x_n)$ -- наблюдения над СВ $X$ в течение $n$ периодов.
		
		СВ $Y$ характеризует ограничения для спроса за указанный период. Ее функция распределения $F_Y(y; b_1, ... b_m)$, зависящий от параметров $b_1, ... b_m$.
		
		Введем СВ $Z = \min(X, Y)$. Тогда $Z$ -- количество действительно проданных билетов в течение рассматриваемого времени и
		$$z_i = min(x_i, y_i)$$
	
		где $\overline{z} = (z_1, ... z_n)$ -- цензурированная выборка наблюдений над СВ $X$.
		
		$$
		z_i =
		\begin{cases}
			x_i & x_i \leq y_i\\
			y_i & x_i > y_i   \\
		\end{cases}
		\quad \forall\, i \in [n]
		$$
		
		\textbf{Задача:}
		
		Требуется оценить $a_i\,\forall\,\in [n]$ -- параметры СВ $X$ (либо также и параметры $b_j\,\forall\,j \in [m]$), используя только $\overline{z}$.
		
		
		%%%
		\subsection{Projection Detruncation (PD)}
		
		0. Возьмем $z^0 = \overline{z}$.
		
		1. По имеющейся выборке $z^k$, стандартными методыми, найдем $\mu^{k}$ и $\sigma^{k}$ -- параметры нормального распределения.
		
		2. Заменим каждый цензурированный элемент $z_i^{k}$ на его проекцию $\xi_i^{k}$:
		
		Пусть $\tau \in ]0; 1[$. Получим $\xi_i^{k}$ из уравнения $\tau = \frac{\int_{\xi^{k}_i}^{+\infty} p^{k}(x) dx}{\int_{z_i^0}^{+\infty} p^{k}(x) dx}$.
		
		3. Получим $z^{k + 1}$.
		
		4. Продолжаем шаги 1-3 до тех пор, пока $|\xi^k_j - \xi^{k - 1}_j| < \epsilon \, \forall \, j \in [n]$, где $\epsilon > 0$ -- заранее заданный порог.
		
		\begin{state}
			Метод всегда сходится.
		\end{state}
		\begin{proof}
			\textcolor{red}{???} метод простых итераций.
		\end{proof}
		
		$\tau$ можно выбирать исходя из требуемой \textit{агрессивности} метода.
		
		%%%
		\subsection{Expectation maximization (EM)}
		
		Каждый цензурированный элемент выборки заменяем на мат. ожидание СВ, распределенной по усеченному слева нормальному распределению, с границей усечения, равной данному цензурированному элементу. Распределение всегда усекается по элементу исходной выборки. Процесс продолжается до сходимости.
		
		%%%
		\subsection{Maximum Likelihood Method (MLM)}
		
		$Z = min(X, Y)$. Цель -- найти $z_1, ... z_n$.
		
		Построим закон распределения $Z$. Используем метод максимального правдоподобия для поиска параметров.
		
		$$\mathcal{L}(a_1, ..., a_p) = \prod^n_{i = 1} f_Z(z_i; a_1, ... , a_p)$$
			
		где $f_Z$ -- плотность вероятности
		
		Для нормального распределения выглядит так:
		
		$$\mathcal{L}(\mu, \sigma) = \prod^n_{i = 1} f_\mathcal{N}(z_i; \mu, \sigma)$$
		
		Далее, будем смотреть на примере нормального распределения.
		
		Затем полученная функция правдоподобия максимизируется
		
		$$\mathcal{L}(\mu, \sigma) \rightarrow \max$$
		
		Также возможна максимизация прологарифмированной функции правдоподобия (т.к. так проще )
		
		$$\log \mathcal{L}(\mu, \sigma) = \sum^n_{i = 1} \log f_\mathcal{N}(z_i; \mu, \sigma) \rightarrow \max$$
		
		\textit{Дальше было быстро и неподробно. Формально -- построение функции распределения, MLM, рассчеты.}
		
		
		
		
		%%%%%
		\newpage
		\section{Лекция 6. Планирование расписаний.}
		
		\textit{Оперативная расстановка ВС по рейсам связанная с изменением данных по спросу}
		
		%%%
		\subsection{Fleet Assignment Model (FAM) + Demand Driven Dispatch ($\text{D}^3$).}
		
		
		\textit{Оперативная замена} (swap) типов ВС на проблемных рейсах (рейсах, на которых спрогнозированный спрос сильно отклонился от реальности): поиск возможных замен, оценка эффективности найденных замен.
		
		\textbf{Поиск возможных замен}
		
		\textit{Цепочка рейсов} -- последовательность стыкующихся между собой рейсов. Критерий стыковки -- совпадение аэропорта прилета предыдущего с аэропортом вылета следующего рейса и возможность осуществления стыковки по времени.
		
		Алгоритм построения множества всех возможных однодневных цепочек по полетному расписанию.
		
		1. Копируем расписание полетов на два дня;
		2. Представим двухдневное расписание в виде графа (вершины -- рейсы; две вершину соединены дугой, если рейсы стыкуются по заранее оговоренным правилам);
		3. С помощью DFS ищем пути от всех вершин рейсов первого дня, до любой из вершин второго дня;
		4. Удаляя последнюю вершину от каждого пути мы, таким образом, находим все однодневные цепочки рейсов.
		
		На выходе получим множество всех цепочек одного дня.
		
		
\end{document}



% Examples and Shortcuts
$
	\begin{defi}
	Определение чего-то
	\end{defi}


	\begin{thm}

	\end{thm}	


	\begin{coll}

	\end{coll}	

	
	\begin{nb}

	\end{nb}	

	
	\begin{nb}

	\end{nb}	


	\begin{exmp}

	\end{exmp}	


	\begin{tikzcd}
	A \arrow[rd] \arrow[r, "\phi"] 
	&B \\
	& C \arrow[u]
	\end{tikzcd}

	% Пример мат. постановки

	$$\text{min} \quad \sum\limits_{e \in E} x_e$$
	
	$$
	\text{s.t.}
	\begin{cases}
		\sum\limits_{e \in E_v} x_e \geq 1& \forall v \in V\\
		x \in \{0, 1\}^{|E|} &
	\end{cases}
	$$

	% Пример алгоритма

	\begin{algorithm}[H]
		\SetAlgoLined
		 \SetKwFunction{FDFS}{DFS}
		 \SetKwProg{Fn}{Function}{:}{}
		 \Fn{\FDFS{$u$}}{
			$VisitFunc(u)$\;
			$visited[u] = True$\;
		        \For{$w \in \text{adj}[u]$}
						{
							\If{$visited[w] = False$}
								{
								$FoundFunc(w)$\;
								$\text{DFS}(w)$\;
								}						
							}
			$OutFunc(u)$\;
		        }

		DFS(start)
		\caption{Depth-first search}
	\end{algorithm}





Случайное число, попадая в тот или иной промежуток будет характеризовать реализацию этого варианта.  Например, вероятность пессимистического варианта = 2/9; целевого = 6/9; оптимистического = 1/9. Если случайное число в интервале от 0 до 2/9, то поток вложений будет равен пессимистической величине вложений, если от 2/9 до 6/9, то целевому, если больше, то оптимистическому.
